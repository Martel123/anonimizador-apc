üîêüí≥ PROMPT ‚Äî LANDING ‚Üí CHECKOUT ‚Üí ACTIVACI√ìN ‚Üí SUPER_ADMIN SIN PAGO + CONTROL DE PRECIOS

Implementa el flujo comercial completo de la plataforma SaaS legal, incluyendo landing p√∫blica, checkout, activaci√≥n de cuentas, onboarding seguro y un rol super_admin con control total, cumpliendo estrictamente lo siguiente:

A) Landing p√∫blica (p√°ginas de marketing)
1Ô∏è‚É£ P√°gina de inicio /

P√°gina p√∫blica de presentaci√≥n del producto.

Mostrar:

descripci√≥n general

beneficios

secci√≥n ‚ÄúPlanes / Precios‚Äù

Los precios NO deben estar hardcodeados.

Los valores deben leerse din√°micamente desde base de datos.

2Ô∏è‚É£ Widget de planes / precios

Mostrar qu√© incluye la plataforma.

Mostrar precio base por persona (ejemplo: USD 69 / persona / mes).

Estos valores deben venir de una tabla PricingConfig.

3Ô∏è‚É£ P√°gina /demo

Mostrar funciones interactivas de la plataforma.

Incluir simulador de costos:

el usuario elige n√∫mero de personas (asientos)

puede elegir addons (si existen)

el sistema calcula el total estimado mensual en tiempo real

El simulador debe usar los precios din√°micos de PricingConfig.

Bot√≥n ‚ÄúConseguir ahora‚Äù ‚Üí redirige a /checkout/start

B) Checkout / compra
4Ô∏è‚É£ P√°gina /checkout/start

Antes de redirigir a la pasarela de pago, pedir:

Datos del estudio jur√≠dico / empresa

Datos del administrador principal:

nombre

email

N√∫mero de asientos seleccionados

Addons (si aplica)

‚ùó IMPORTANTE:

NO pedir contrase√±a en esta etapa

Crear un CheckoutSession en BD con estado pending_payment

5Ô∏è‚É£ Pago

Redirigir a checkout externo seguro (Stripe recomendado; arquitectura compatible con Izipay).

El frontend no confirma pagos.

El backend solo cambia estado mediante webhooks del proveedor.

C) Confirmaci√≥n y creaci√≥n autom√°tica de cuenta
6Ô∏è‚É£ Webhook de pago exitoso

Cuando el proveedor confirme el pago:

Crear el Tenant / Estudio

Crear el usuario admin con el email indicado

Asignar:

seats_purchased = N

seats_used = 1

Activar suscripci√≥n (subscription_status = active)

7Ô∏è‚É£ P√°gina /checkout/success

Mostrar:

‚ÄúPago confirmado correctamente‚Äù

Bot√≥n ‚ÄúAccede a tu cuenta‚Äù

Al hacer clic:

enviar magic link o pantalla de crear contrase√±a (set password con token)

D) Primer ingreso obligatorio (seguridad + onboarding)
8Ô∏è‚É£ Primer login del admin

Forzar configuraci√≥n de 2FA (Google Authenticator ‚Äì TOTP) antes de entrar al dashboard.

9Ô∏è‚É£ Wizard inicial

Pantalla para crear/invitar usuarios.

Mostrar contador:

‚ÄúAsientos usados X / N‚Äù

Bloquear creaci√≥n si excede el n√∫mero comprado.

E) Enforzamiento de l√≠mites

El backend debe validar siempre:

no permitir crear usuarios si seats_used >= seats_purchased

Nunca confiar solo en el frontend.

F) Super_admin (MUY IMPORTANTE)

Implementa un rol super_admin con estas reglas:

El super_admin:

NO paga

NO pasa por checkout

NO ve landing de precios ni planes

ingresa directamente a la plataforma

El super_admin puede:

crear estudios manualmente

asignar cualquier cantidad de asientos

crear usuarios ilimitados

ver todas las empresas y usuarios

G) Control de precios por super_admin

Implementa un Panel del sistema exclusivo para super_admin:

Ruta ejemplo: /system/pricing

Permitir:

editar precio por persona

activar/desactivar addons

cambiar moneda

Los cambios:

se guardan en BD (PricingConfig)

se reflejan autom√°ticamente en:

landing

simulador de costos

checkout

H) Entregables obligatorios

Antes de implementar c√≥digo, explica:

las rutas completas del flujo

los modelos de BD necesarios

c√≥mo se protege el webhook

c√≥mo funciona el magic link / set password

c√≥mo se fuerza el 2FA

c√≥mo el super_admin modifica precios sin redeploy

NO asumas el stack. Primero identif√≠calo y adapta la soluci√≥n.