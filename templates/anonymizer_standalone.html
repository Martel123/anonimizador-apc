<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Anonimizador Legal | APC Jurídica</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='anonymizer.css') }}">
</head>
<body>
  <header class="header">
    <div class="header-logo">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
        <path d="M2 17l10 5 10-5"/>
        <path d="M2 12l10 5 10-5"/>
      </svg>
    </div>
    <div>
      <div class="header-title">APC Jurídica</div>
      <div class="header-subtitle">Anonimizador de Documentos Legales</div>
    </div>
  </header>

  <main class="main-container">
    <div class="card upload-card">
      <h1 class="card-title">Anonimizar Documento</h1>
      <p class="card-description">
        Suba un documento legal para detectar y anonimizar automáticamente datos personales como DNI, nombres, direcciones y más.
      </p>

      {% if error %}
      <div class="alert alert-error">
        {{ error }}
      </div>
      {% endif %}

      {% if not openai_available %}
      <div class="alert alert-error">
        <strong>Servicio no disponible</strong><br>
        <span style="font-size: 13px;">OPENAI_API_KEY no configurada. Contacte al administrador.</span>
      </div>
      {% endif %}

      <form id="uploadForm" action="/anonymizer/process" method="POST" enctype="multipart/form-data">
        <div id="dropzone" class="dropzone">
          <div class="dropzone-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
          </div>
          <div class="dropzone-text">Arrastre su documento aquí</div>
          <div class="dropzone-hint">o <strong>haga clic para seleccionar</strong></div>
        </div>

        <input type="file" id="fileInput" name="file" accept=".doc,.docx,.pdf,.txt">

        <div id="filePreview" class="file-preview">
          <div class="file-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            </svg>
          </div>
          <div class="file-info">
            <div id="fileName" class="file-name">documento.docx</div>
            <div id="fileSize" class="file-size">1.2 MB</div>
          </div>
          <button type="button" id="fileRemove" class="file-remove" title="Quitar archivo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>

        <div class="formats-list">
          <span class="format-badge">DOCX</span>
          <span class="format-badge">PDF</span>
          <span class="format-badge">TXT</span>
          <span class="format-badge">DOC</span>
        </div>

        <button type="submit" id="submitBtn" class="btn btn-primary" disabled style="margin-top: 24px;" {% if not openai_available %}disabled{% endif %}>
          <span id="submitSpinner" class="spinner" style="display: none;"></span>
          <span id="submitText">Analizar documento</span>
        </button>
      </form>

      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
          </div>
          <div>
            <div class="feature-title">Confidencial</div>
            <div class="feature-desc">Archivos eliminados inmediatamente</div>
          </div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
              <circle cx="8.5" cy="7" r="4"/>
              <polyline points="17 11 19 13 23 9"/>
            </svg>
          </div>
          <div>
            <div class="feature-title">Revisión manual</div>
            <div class="feature-desc">Selecciona qué datos tokenizar</div>
          </div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="16 18 22 12 16 6"/>
              <polyline points="8 6 2 12 8 18"/>
            </svg>
          </div>
          <div>
            <div class="feature-title">Tokens claros</div>
            <div class="feature-desc">{{PERSONA_1}}, {{DNI_1}}, etc.</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
      <span>Procesamiento confidencial - sin almacenamiento permanente</span>
    </div>
    <div class="footer-brand">APC Jurídica</div>
  </footer>

  <script src="{{ url_for('static', filename='anonymizer.js') }}"></script>
</body>
</html>
